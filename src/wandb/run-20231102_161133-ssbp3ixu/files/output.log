using loss: easy
neuralODE use input scaling with tanh
use residual network: input_size=400, output_size=98
start training - model id=99
model-id: 99
using GPU
model params:
{"batch_size": 30, "bias": true, "dataset": "microbial_genus", "dataset_id": "no_abx", "delta_t": 0.00625, "dropout_rate": 0.1, "enc_nn": [[150, "tanh"], [150, "tanh"]], "epochs": 10000, "hidden_size": 400, "input_size": 106, "input_vars": ["id"], "learning_rate": 0.001, "ode_nn": [[400, "tanh"], [400, "relu"]], "options": {"add_dynamic_cov": true, "add_pred": [], "add_readout_activation": ["sum2one", ["id"]], "enc_input_t": false, "eval_metrics": ["exp", "std"], "evaluate": false, "func_appl_X": [], "input_current_t": true, "input_sig": false, "parallel": true, "periodic_current_t": true, "plot_moments": false, "plot_variance": false, "pre-train": 10000, "resume_training": false, "scale_dt": 1.0, "solver_delta_t_factor": 0.14285714285714285, "std_factor": 1.96, "test": false, "use_cond_exp": true, "which_loss": "easy", "which_val_loss": "standard", "zero_weight_init": false}, "output_size": 98, "output_vars": ["id"], "readout_nn": [[150, "tanh"], [150, "tanh"]], "seed": 398, "solver": "euler", "t_period": 1.0, "test_size": 0.2, "use_rnn": true, "weight": 0.5, "weight_evolve": null, "zero_weight_init": false}
initiate new model ...
model overview:
NJODE(
  (ode_f): ODEFunc(
    (f): Sequential(
      (0): Linear(in_features=510, out_features=400, bias=True)
      (1): Tanh()
      (2): Dropout(p=0.1, inplace=False)
      (3): Linear(in_features=400, out_features=400, bias=True)
      (4): ReLU()
      (5): Dropout(p=0.1, inplace=False)
      (6): Linear(in_features=400, out_features=400, bias=True)
    )
  )
  (encoder_map): FFNN(
    (ffnn): Sequential(
      (0): Linear(in_features=506, out_features=150, bias=True)
      (1): Tanh()
      (2): Dropout(p=0.1, inplace=False)
      (3): Linear(in_features=150, out_features=150, bias=True)
      (4): Tanh()
      (5): Dropout(p=0.1, inplace=False)
      (6): Linear(in_features=150, out_features=400, bias=True)
    )
  )
  (readout_map): FFNN(
    (ffnn): Sequential(
      (0): Linear(in_features=400, out_features=150, bias=True)
      (1): Tanh()
      (2): Dropout(p=0.1, inplace=False)
      (3): Linear(in_features=150, out_features=150, bias=True)
      (4): Tanh()
      (5): Dropout(p=0.1, inplace=False)
      (6): Linear(in_features=150, out_features=98, bias=True)
    )
  )
)
# parameters=781898
# trainable parameters=781898
start training ...

4it [00:05,  1.38s/it]
0it [00:00, ?it/s]


2it [00:03,  1.69s/it]
4it [00:05,  1.40s/it]


2it [00:03,  1.84s/it]
4it [00:05,  1.34s/it]

4it [00:05,  1.34s/it]
0it [00:00, ?it/s]


4it [00:05,  1.45s/it]
0it [00:00, ?it/s]


2it [00:03,  1.84s/it]
4it [00:05,  1.43s/it]


2it [00:03,  1.67s/it]
4it [00:05,  1.33s/it]


3it [00:05,  1.69s/it]
4it [00:05,  1.35s/it]

2it [00:03,  1.92s/it]
4it [00:05,  1.33s/it]


2it [00:03,  1.55s/it]
4it [00:05,  1.30s/it]

4it [00:05,  1.36s/it]
0it [00:00, ?it/s]


4it [00:05,  1.38s/it]
0it [00:00, ?it/s]


2it [00:03,  1.64s/it]
4it [00:05,  1.38s/it]


2it [00:03,  1.64s/it]
4it [00:05,  1.37s/it]


3it [00:05,  1.79s/it]
4it [00:05,  1.47s/it]


2it [00:04,  2.10s/it]
4it [00:05,  1.44s/it]


3it [00:05,  1.92s/it]
4it [00:05,  1.47s/it]
4it [00:05,  1.46s/it]
0it [00:00, ?it/s]

4it [00:05,  1.43s/it]
0it [00:00, ?it/s]


4it [00:05,  1.47s/it]
0it [00:00, ?it/s]


2it [00:03,  1.90s/it]
4it [00:05,  1.48s/it]


2it [00:03,  1.87s/it]
4it [00:05,  1.46s/it]


2it [00:03,  1.61s/it]
4it [00:05,  1.46s/it]


2it [00:03,  1.55s/it]
4it [00:05,  1.37s/it]

4it [00:05,  1.35s/it]
0it [00:00, ?it/s]


2it [00:03,  1.84s/it]
4it [00:05,  1.34s/it]


2it [00:03,  1.86s/it]
4it [00:05,  1.34s/it]


3it [00:05,  1.81s/it]
4it [00:05,  1.36s/it]

4it [00:05,  1.39s/it]
0it [00:00, ?it/s]


2it [00:03,  1.66s/it]
4it [00:05,  1.34s/it]


2it [00:03,  1.62s/it]
4it [00:05,  1.31s/it]

4it [00:05,  1.38s/it]
0it [00:00, ?it/s]


2it [00:04,  2.09s/it]
4it [00:05,  1.39s/it]


2it [00:03,  1.98s/it]
4it [00:05,  1.41s/it]


2it [00:03,  1.78s/it]
4it [00:05,  1.37s/it]

4it [00:05,  1.40s/it]
0it [00:00, ?it/s]


4it [00:05,  1.37s/it]
0it [00:00, ?it/s]


2it [00:03,  1.78s/it]
4it [00:05,  1.39s/it]


2it [00:03,  1.89s/it]
4it [00:05,  1.36s/it]

4it [00:05,  1.38s/it]
0it [00:00, ?it/s]

4it [00:05,  1.41s/it]
0it [00:00, ?it/s]


2it [00:03,  1.75s/it]
4it [00:05,  1.43s/it]


2it [00:03,  1.81s/it]
4it [00:05,  1.47s/it]


2it [00:03,  2.03s/it]
4it [00:05,  1.44s/it]


2it [00:04,  2.03s/it]
4it [00:05,  1.44s/it]


2it [00:03,  1.68s/it]
4it [00:05,  1.46s/it]


2it [00:03,  1.88s/it]
4it [00:05,  1.46s/it]


3it [00:05,  1.79s/it]
4it [00:05,  1.43s/it]

4it [00:05,  1.43s/it]
0it [00:00, ?it/s]


4it [00:05,  1.45s/it]
0it [00:00, ?it/s]


2it [00:03,  2.09s/it]
4it [00:05,  1.43s/it]


2it [00:03,  1.91s/it]
4it [00:05,  1.46s/it]


2it [00:03,  1.82s/it]
4it [00:05,  1.48s/it]


2it [00:03,  1.84s/it]
4it [00:05,  1.48s/it]


2it [00:03,  1.84s/it]
4it [00:05,  1.44s/it]


2it [00:04,  2.12s/it]
4it [00:05,  1.45s/it]

2it [00:03,  1.91s/it]
4it [00:05,  1.47s/it]

4it [00:05,  1.39s/it]
0it [00:00, ?it/s]


4it [00:05,  1.38s/it]
0it [00:00, ?it/s]


2it [00:03,  1.94s/it]
4it [00:05,  1.38s/it]


2it [00:03,  1.54s/it]
4it [00:05,  1.34s/it]

4it [00:05,  1.40s/it]
0it [00:00, ?it/s]


4it [00:05,  1.45s/it]
0it [00:00, ?it/s]


2it [00:03,  1.79s/it]
4it [00:05,  1.33s/it]


3it [00:05,  1.65s/it]
4it [00:05,  1.30s/it]

2it [00:03,  1.69s/it]
4it [00:05,  1.30s/it]


2it [00:03,  1.69s/it]
4it [00:05,  1.30s/it]

4it [00:05,  1.33s/it]
0it [00:00, ?it/s]


2it [00:03,  1.88s/it]
4it [00:05,  1.35s/it]


2it [00:03,  1.84s/it]
4it [00:05,  1.37s/it]


3it [00:05,  1.88s/it]
4it [00:05,  1.37s/it]

4it [00:05,  1.42s/it]
0it [00:00, ?it/s]


4it [00:05,  1.46s/it]
0it [00:00, ?it/s]


4it [00:05,  1.45s/it]
0it [00:00, ?it/s]


2it [00:03,  1.86s/it]
4it [00:05,  1.44s/it]


2it [00:03,  1.92s/it]
4it [00:05,  1.44s/it]


2it [00:04,  2.02s/it]
4it [00:05,  1.41s/it]


2it [00:03,  1.79s/it]
4it [00:05,  1.43s/it]


3it [00:05,  1.87s/it]
4it [00:05,  1.46s/it]

4it [00:05,  1.45s/it]
0it [00:00, ?it/s]

4it [00:05,  1.41s/it]
0it [00:00, ?it/s]


2it [00:02,  1.39s/it]
4it [00:05,  1.32s/it]


3it [00:05,  1.79s/it]
4it [00:05,  1.32s/it]

4it [00:05,  1.31s/it]
0it [00:00, ?it/s]


2it [00:03,  1.80s/it]
4it [00:05,  1.31s/it]

4it [00:05,  1.31s/it]
0it [00:00, ?it/s]


2it [00:03,  1.65s/it]
4it [00:05,  1.34s/it]


2it [00:03,  1.50s/it]
4it [00:05,  1.27s/it]

4it [00:05,  1.32s/it]
0it [00:00, ?it/s]


2it [00:03,  1.56s/it]
4it [00:05,  1.34s/it]

2it [00:03,  1.46s/it]
4it [00:05,  1.38s/it]

4it [00:05,  1.37s/it]
0it [00:00, ?it/s]

2it [00:03,  2.06s/it]
4it [00:05,  1.35s/it]


2it [00:03,  1.92s/it]
4it [00:05,  1.41s/it]


2it [00:03,  1.82s/it]
4it [00:05,  1.42s/it]

4it [00:05,  1.37s/it]
0it [00:00, ?it/s]


4it [00:05,  1.37s/it]
0it [00:00, ?it/s]


2it [00:03,  1.91s/it]
4it [00:05,  1.41s/it]


2it [00:03,  1.92s/it]
4it [00:05,  1.46s/it]



4it [00:05,  1.44s/it]
epoch 100, weight=0.50000, train-loss=0.82662, eval-loss=0.91602, val-loss=0.23900,
plotting ...
save model ...
saved!
save new best model: last-best-loss: inf, new-best-loss: 0.23900, epoch: 100
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5
1it [00:01,  1.69s/it]
2it [00:03,  1.66s/it]
2it [00:03,  1.66s/it]
0it [00:00, ?it/s]/it]
1it [00:02,  2.06s/it]
2it [00:03,  1.83s/it]
2it [00:03,  1.83s/it]
0it [00:00, ?it/s]/it]
1it [00:01,  1.78s/it]
2it [00:03,  1.83s/it]
2it [00:03,  1.83s/it]
0it [00:00, ?it/s]/it]
1it [00:02,  2.08s/it]
0it [00:00, ?it/s]/it]
0it [00:00, ?it/s]/it]
2it [00:03,  2.00s/it]
0it [00:00, ?it/s]/it]
0it [00:00, ?it/s]/it]
1it [00:01,  1.83s/it]
2it [00:03,  1.80s/it]
0it [00:00, ?it/s]/it]
0it [00:00, ?it/s]/it]
1it [00:01,  1.68s/it]
2it [00:03,  1.78s/it]
2it [00:03,  1.78s/it]
0it [00:00, ?it/s]/it]
1it [00:02,  2.20s/it]
2it [00:04,  2.11s/it]
2it [00:04,  2.11s/it]
0it [00:00, ?it/s]/it]
1it [00:01,  1.95s/it]
2it [00:03,  1.81s/it]
2it [00:03,  1.81s/it]
0it [00:00, ?it/s]/it]
1it [00:01,  1.86s/it]
2it [00:03,  1.83s/it]
2it [00:03,  1.83s/it]
0it [00:00, ?it/s]/it]
1it [00:01,  1.81s/it]
2it [00:03,  1.79s/it]
2it [00:03,  1.79s/it]
1it [00:01,  1.27s/it]
2it [00:03,  1.54s/it]
2it [00:03,  1.54s/it]
1it [00:01,  1.72s/it]
2it [00:03,  1.74s/it]
0it [00:00, ?it/s]/it]
0it [00:00, ?it/s]/it]
1it [00:01,  1.88s/it]
2it [00:03,  1.81s/it]
2it [00:03,  1.81s/it]
0it [00:00, ?it/s]/it]
1it [00:01,  1.64s/it]
2it [00:03,  1.58s/it]
2it [00:03,  1.58s/it]
0it [00:00, ?it/s]/it]
1it [00:01,  1.45s/it]
3it [00:05,  1.64s/it]
3it [00:05,  1.64s/it]
1it [00:01,  1.54s/it]
2it [00:03,  1.69s/it]
0it [00:00, ?it/s]/it]
0it [00:00, ?it/s]/it]
1it [00:01,  1.99s/it]
0it [00:00, ?it/s]/it]
0it [00:00, ?it/s]/it]
1it [00:01,  1.53s/it]
2it [00:03,  1.66s/it]
2it [00:03,  1.66s/it]
0it [00:00, ?it/s]/it]
1it [00:01,  1.73s/it]
2it [00:03,  1.83s/it]
2it [00:03,  1.83s/it]
1it [00:01,  1.73s/it]
0it [00:00, ?it/s]/it]
0it [00:00, ?it/s]/it]
1it [00:01,  1.92s/it]
2it [00:03,  1.76s/it]
2it [00:03,  1.76s/it]
0it [00:00, ?it/s]/it]
1it [00:01,  1.47s/it]
2it [00:03,  1.61s/it]
2it [00:03,  1.61s/it]
0it [00:00, ?it/s]/it]
2it [00:03,  1.80s/it]
0it [00:00, ?it/s]/it]
0it [00:00, ?it/s]/it]
1it [00:01,  1.99s/it]
2it [00:03,  1.94s/it]
0it [00:00, ?it/s]/it]
0it [00:00, ?it/s]/it]
1it [00:01,  1.42s/it]
2it [00:03,  1.62s/it]
2it [00:03,  1.62s/it]
0it [00:00, ?it/s]/it]
1it [00:01,  1.90s/it]
2it [00:03,  1.82s/it]
2it [00:03,  1.82s/it]
1it [00:01,  1.36s/it]
2it [00:03,  1.49s/it]
2it [00:03,  1.49s/it]
0it [00:00, ?it/s]/it]
1it [00:02,  2.02s/it]
3it [00:05,  1.91s/it]
3it [00:05,  1.91s/it]
1it [00:01,  1.45s/it]
2it [00:03,  1.62s/it]
0it [00:00, ?it/s]/it]
0it [00:00, ?it/s]/it]
1it [00:02,  2.19s/it]
0it [00:00, ?it/s]/it]
0it [00:00, ?it/s]/it]
1it [00:02,  2.14s/it]
2it [00:03,  1.96s/it]
0it [00:00, ?it/s]/it]
0it [00:00, ?it/s]/it]
1it [00:01,  1.91s/it]
2it [00:03,  1.85s/it]
0it [00:00, ?it/s]/it]
0it [00:00, ?it/s]/it]
1it [00:01,  1.91s/it]
2it [00:03,  1.84s/it]
2it [00:03,  1.84s/it]
0it [00:00, ?it/s]/it]
1it [00:01,  1.93s/it]
2it [00:04,  2.02s/it]
2it [00:04,  2.02s/it]
0it [00:00, ?it/s]/it]
1it [00:02,  2.37s/it]
2it [00:03,  2.08s/it]
2it [00:03,  2.08s/it]
0it [00:00, ?it/s]/it]
2it [00:03,  1.84s/it]
0it [00:00, ?it/s]/it]
0it [00:00, ?it/s]/it]
1it [00:01,  1.60s/it]
2it [00:03,  1.65s/it]
2it [00:03,  1.65s/it]
0it [00:00, ?it/s]/it]
1it [00:01,  1.81s/it]
2it [00:03,  1.74s/it]
2it [00:03,  1.74s/it]
0it [00:00, ?it/s]/it]
2it [00:03,  1.81s/it]
0it [00:00, ?it/s]/it]
0it [00:00, ?it/s]/it]
1it [00:02,  2.08s/it]
KeyboardInterruptable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward passnit__.py", line 175, in backwardr_ync
KeyboardInterruptable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward passnit__.py", line 175, in backwardr_ync
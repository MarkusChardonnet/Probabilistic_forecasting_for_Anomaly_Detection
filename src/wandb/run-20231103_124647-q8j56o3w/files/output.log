using loss: easy
neuralODE use input scaling with tanh
use residual network: input_size=400, output_size=98
start training - model id=115
model-id: 115
using GPU
model params:
{"batch_size": 30, "bias": true, "dataset": "microbial_genus", "dataset_id": "all", "delta_t": 0.00625, "dropout_rate": 0.1, "enc_nn": [[200, "tanh"], [300, "tanh"]], "epochs": 10000, "hidden_size": 400, "input_size": 106, "input_vars": ["id"], "learning_rate": 0.001, "ode_nn": [[200, "tanh"], [200, "relu"]], "options": {"add_dynamic_cov": true, "add_pred": [], "add_readout_activation": ["sum2one", ["id"]], "enc_input_t": false, "eval_metrics": ["exp", "std"], "evaluate": false, "func_appl_X": [], "input_current_t": true, "input_sig": false, "parallel": true, "periodic_current_t": true, "plot_moments": false, "plot_variance": false, "pre-train": 10000, "resume_training": false, "scale_dt": 1.0, "solver_delta_t_factor": 0.14285714285714285, "std_factor": 1.96, "test": false, "use_cond_exp": true, "which_loss": "easy", "which_val_loss": "standard", "zero_weight_init": false}, "output_size": 98, "output_vars": ["id"], "readout_nn": [[300, "tanh"], [200, "tanh"]], "seed": 398, "solver": "euler", "t_period": 1.0, "test_size": 0.2, "use_rnn": true, "weight": 0.5, "weight_evolve": null, "zero_weight_init": false}
initiate new model ...
model overview:
NJODE(
  (ode_f): ODEFunc(
    (f): Sequential(
      (0): Linear(in_features=510, out_features=200, bias=True)
      (1): Tanh()
      (2): Dropout(p=0.1, inplace=False)
      (3): Linear(in_features=200, out_features=200, bias=True)
      (4): ReLU()
      (5): Dropout(p=0.1, inplace=False)
      (6): Linear(in_features=200, out_features=400, bias=True)
    )
  )
  (encoder_map): FFNN(
    (ffnn): Sequential(
      (0): Linear(in_features=506, out_features=200, bias=True)
      (1): Tanh()
      (2): Dropout(p=0.1, inplace=False)
      (3): Linear(in_features=200, out_features=300, bias=True)
      (4): Tanh()
      (5): Dropout(p=0.1, inplace=False)
      (6): Linear(in_features=300, out_features=400, bias=True)
    )
  )
  (readout_map): FFNN(
    (ffnn): Sequential(
      (0): Linear(in_features=400, out_features=300, bias=True)
      (1): Tanh()
      (2): Dropout(p=0.1, inplace=False)
      (3): Linear(in_features=300, out_features=200, bias=True)
      (4): Tanh()
      (5): Dropout(p=0.1, inplace=False)
      (6): Linear(in_features=200, out_features=98, bias=True)
    )
  )
)
# parameters=705098
# trainable parameters=705098
start training ...







7it [00:27,  3.97s/it]
epoch 1, weight=0.50000, train-loss=0.87414, eval-loss=1.45803, val-loss=2.45706,
plotting ...
save model ...
saved!
save new best model: last-best-loss: inf, new-best-loss: 2.45706, epoch: 1
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:26,  3.75s/it]
epoch 2, weight=0.50000, train-loss=0.94632, eval-loss=0.88907, val-loss=0.32284,
plotting ...
save model ...
saved!
save new best model: last-best-loss: 2.45706, new-best-loss: 0.32284, epoch: 2
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:26,  3.84s/it]
epoch 3, weight=0.50000, train-loss=0.82548, eval-loss=14.28818, val-loss=17.26302,
plotting ...
0it [00:00, ?it/s]
save model ...
saved!
----------------------------------------------------------------------------------------------------







7it [00:27,  3.98s/it]
epoch 4, weight=0.50000, train-loss=0.77234, eval-loss=0.88235, val-loss=0.29333,
plotting ...
0it [00:00, ?it/s]
save model ...
saved!
save new best model: last-best-loss: 0.32284, new-best-loss: 0.29333, epoch: 4
saved!
----------------------------------------------------------------------------------------------------







7it [00:26,  3.79s/it]
epoch 5, weight=0.50000, train-loss=0.74925, eval-loss=0.88871, val-loss=0.23362,
plotting ...
0it [00:00, ?it/s]
save model ...
saved!
save new best model: last-best-loss: 0.29333, new-best-loss: 0.23362, epoch: 5
saved!
----------------------------------------------------------------------------------------------------







7it [00:26,  3.78s/it]
epoch 6, weight=0.50000, train-loss=0.90181, eval-loss=0.88403, val-loss=0.23246,
plotting ...
save model ...
saved!
save new best model: last-best-loss: 0.23362, new-best-loss: 0.23246, epoch: 6
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:26,  3.77s/it]
epoch 7, weight=0.50000, train-loss=0.84598, eval-loss=0.88271, val-loss=0.23235,
plotting ...
save model ...
saved!
save new best model: last-best-loss: 0.23246, new-best-loss: 0.23235, epoch: 7
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:31,  4.49s/it]
epoch 8, weight=0.50000, train-loss=0.85008, eval-loss=0.88215, val-loss=0.23234,
plotting ...
0it [00:00, ?it/s]
save model ...
saved!
save new best model: last-best-loss: 0.23235, new-best-loss: 0.23234, epoch: 8
saved!
----------------------------------------------------------------------------------------------------







7it [00:26,  3.84s/it]
epoch 9, weight=0.50000, train-loss=0.88141, eval-loss=0.88187, val-loss=0.23235,
plotting ...
save model ...
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:26,  3.81s/it]
epoch 10, weight=0.50000, train-loss=0.82944, eval-loss=0.88173, val-loss=0.23235,
plotting ...
0it [00:00, ?it/s]
save model ...
saved!
----------------------------------------------------------------------------------------------------







7it [00:26,  3.78s/it]
epoch 11, weight=0.50000, train-loss=0.89735, eval-loss=0.88166, val-loss=0.23235,
plotting ...
0it [00:00, ?it/s]
save model ...
saved!
----------------------------------------------------------------------------------------------------







7it [00:27,  3.88s/it]
epoch 12, weight=0.50000, train-loss=0.81808, eval-loss=0.88161, val-loss=0.23235,
plotting ...
save model ...
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:26,  3.80s/it]
epoch 13, weight=0.50000, train-loss=0.82813, eval-loss=0.88158, val-loss=0.23235,
plotting ...
save model ...
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:26,  3.86s/it]
epoch 14, weight=0.50000, train-loss=0.80989, eval-loss=0.88155, val-loss=0.23234,
plotting ...
save model ...
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:26,  3.77s/it]
epoch 15, weight=0.50000, train-loss=0.81604, eval-loss=0.88153, val-loss=0.23234,
plotting ...
0it [00:00, ?it/s]
save model ...
saved!
save new best model: last-best-loss: 0.23234, new-best-loss: 0.23234, epoch: 15
saved!
----------------------------------------------------------------------------------------------------







7it [00:26,  3.72s/it]
epoch 16, weight=0.50000, train-loss=0.81313, eval-loss=0.88151, val-loss=0.23233,
plotting ...
0it [00:00, ?it/s]
save model ...
saved!
save new best model: last-best-loss: 0.23234, new-best-loss: 0.23233, epoch: 16
saved!
----------------------------------------------------------------------------------------------------







7it [00:26,  3.74s/it]
epoch 17, weight=0.50000, train-loss=0.81809, eval-loss=0.88150, val-loss=0.23233,
plotting ...
0it [00:00, ?it/s]
save model ...
saved!
save new best model: last-best-loss: 0.23233, new-best-loss: 0.23233, epoch: 17
saved!
----------------------------------------------------------------------------------------------------







7it [00:26,  3.76s/it]
epoch 18, weight=0.50000, train-loss=0.86965, eval-loss=0.88148, val-loss=0.23232,
plotting ...
0it [00:00, ?it/s]
save model ...
saved!
save new best model: last-best-loss: 0.23233, new-best-loss: 0.23232, epoch: 18
saved!
----------------------------------------------------------------------------------------------------







7it [00:27,  3.86s/it]
epoch 19, weight=0.50000, train-loss=0.86883, eval-loss=0.88146, val-loss=0.23232,
plotting ...
0it [00:00, ?it/s]
save model ...
saved!
save new best model: last-best-loss: 0.23232, new-best-loss: 0.23232, epoch: 19
saved!
----------------------------------------------------------------------------------------------------







7it [00:39,  5.69s/it]
epoch 20, weight=0.50000, train-loss=0.84606, eval-loss=0.88144, val-loss=0.23231,
plotting ...
save model ...
saved!
save new best model: last-best-loss: 0.23232, new-best-loss: 0.23231, epoch: 20
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:35,  5.03s/it]
epoch 21, weight=0.50000, train-loss=0.83943, eval-loss=0.88142, val-loss=0.23231,
plotting ...
save model ...
saved!
save new best model: last-best-loss: 0.23231, new-best-loss: 0.23231, epoch: 21
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:35,  5.08s/it]
epoch 22, weight=0.50000, train-loss=0.85342, eval-loss=0.88140, val-loss=0.23230,
plotting ...
save model ...
saved!
save new best model: last-best-loss: 0.23231, new-best-loss: 0.23230, epoch: 22
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:37,  5.35s/it]
epoch 23, weight=0.50000, train-loss=0.84433, eval-loss=0.88138, val-loss=0.23230,
plotting ...
0it [00:00, ?it/s]
save model ...
saved!
save new best model: last-best-loss: 0.23230, new-best-loss: 0.23230, epoch: 23
saved!
----------------------------------------------------------------------------------------------------







7it [00:37,  5.34s/it]
epoch 24, weight=0.50000, train-loss=0.88268, eval-loss=0.88137, val-loss=0.23229,
plotting ...
save model ...
saved!
save new best model: last-best-loss: 0.23230, new-best-loss: 0.23229, epoch: 24
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:34,  4.90s/it]
epoch 25, weight=0.50000, train-loss=0.86921, eval-loss=0.88135, val-loss=0.23229,
plotting ...
save model ...
saved!
save new best model: last-best-loss: 0.23229, new-best-loss: 0.23229, epoch: 25
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:35,  5.04s/it]
epoch 26, weight=0.50000, train-loss=0.88281, eval-loss=0.88133, val-loss=0.23228,
plotting ...
0it [00:00, ?it/s]
save model ...
saved!
save new best model: last-best-loss: 0.23229, new-best-loss: 0.23228, epoch: 26
saved!
----------------------------------------------------------------------------------------------------







7it [00:35,  5.01s/it]
epoch 27, weight=0.50000, train-loss=0.91048, eval-loss=0.88131, val-loss=0.23228,
plotting ...
save model ...
saved!
save new best model: last-best-loss: 0.23228, new-best-loss: 0.23228, epoch: 27
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:34,  4.96s/it]
epoch 28, weight=0.50000, train-loss=0.78899, eval-loss=0.88129, val-loss=0.23227,
plotting ...
save model ...
saved!
save new best model: last-best-loss: 0.23228, new-best-loss: 0.23227, epoch: 28
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:35,  5.09s/it]
epoch 29, weight=0.50000, train-loss=0.86052, eval-loss=0.88127, val-loss=0.23227,
plotting ...
0it [00:00, ?it/s]
save model ...
saved!
save new best model: last-best-loss: 0.23227, new-best-loss: 0.23227, epoch: 29
saved!
----------------------------------------------------------------------------------------------------







7it [00:36,  5.22s/it]
epoch 30, weight=0.50000, train-loss=0.86472, eval-loss=0.88125, val-loss=0.23226,
plotting ...
save model ...
saved!
save new best model: last-best-loss: 0.23227, new-best-loss: 0.23226, epoch: 30
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:38,  5.48s/it]
epoch 31, weight=0.50000, train-loss=0.84844, eval-loss=0.88123, val-loss=0.23226,
plotting ...
0it [00:00, ?it/s]
save model ...
saved!
save new best model: last-best-loss: 0.23226, new-best-loss: 0.23226, epoch: 31
saved!
----------------------------------------------------------------------------------------------------







7it [00:34,  4.99s/it]
epoch 32, weight=0.50000, train-loss=0.85345, eval-loss=0.88121, val-loss=0.23225,
plotting ...
0it [00:00, ?it/s]
save model ...
saved!
save new best model: last-best-loss: 0.23226, new-best-loss: 0.23225, epoch: 32
saved!
----------------------------------------------------------------------------------------------------







7it [00:35,  5.03s/it]
epoch 33, weight=0.50000, train-loss=0.83908, eval-loss=0.88119, val-loss=0.23225,
plotting ...
0it [00:00, ?it/s]
save model ...
saved!
save new best model: last-best-loss: 0.23225, new-best-loss: 0.23225, epoch: 33
saved!
----------------------------------------------------------------------------------------------------







7it [00:37,  5.30s/it]
epoch 34, weight=0.50000, train-loss=0.80226, eval-loss=0.88117, val-loss=0.23224,
plotting ...
0it [00:00, ?it/s]
save model ...
saved!
save new best model: last-best-loss: 0.23225, new-best-loss: 0.23224, epoch: 34
saved!
----------------------------------------------------------------------------------------------------







7it [00:38,  5.45s/it]
epoch 35, weight=0.50000, train-loss=0.79585, eval-loss=0.88115, val-loss=0.23223,
plotting ...
save model ...
saved!
save new best model: last-best-loss: 0.23224, new-best-loss: 0.23223, epoch: 35
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:34,  4.98s/it]
epoch 36, weight=0.50000, train-loss=0.91780, eval-loss=0.88113, val-loss=0.23223,
plotting ...
0it [00:00, ?it/s]
save model ...
saved!
save new best model: last-best-loss: 0.23223, new-best-loss: 0.23223, epoch: 36
saved!
----------------------------------------------------------------------------------------------------







7it [00:35,  5.05s/it]
epoch 37, weight=0.50000, train-loss=0.88430, eval-loss=0.88111, val-loss=0.23222,
plotting ...
0it [00:00, ?it/s]
save model ...
saved!
save new best model: last-best-loss: 0.23223, new-best-loss: 0.23222, epoch: 37
saved!
----------------------------------------------------------------------------------------------------







7it [00:35,  5.13s/it]
epoch 38, weight=0.50000, train-loss=0.80488, eval-loss=0.88109, val-loss=0.23222,
plotting ...
save model ...
saved!
save new best model: last-best-loss: 0.23222, new-best-loss: 0.23222, epoch: 38
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:35,  5.07s/it]
epoch 39, weight=0.50000, train-loss=0.85991, eval-loss=0.88106, val-loss=0.23221,
plotting ...
save model ...
saved!
save new best model: last-best-loss: 0.23222, new-best-loss: 0.23221, epoch: 39
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:35,  5.02s/it]
epoch 40, weight=0.50000, train-loss=0.81999, eval-loss=0.88104, val-loss=0.23221,
plotting ...
save model ...
saved!
save new best model: last-best-loss: 0.23221, new-best-loss: 0.23221, epoch: 40
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:35,  5.09s/it]
epoch 41, weight=0.50000, train-loss=0.94553, eval-loss=0.88102, val-loss=0.23220,
plotting ...
save model ...
saved!
save new best model: last-best-loss: 0.23221, new-best-loss: 0.23220, epoch: 41
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:36,  5.22s/it]
epoch 42, weight=0.50000, train-loss=0.76434, eval-loss=0.88100, val-loss=0.23219,
plotting ...
save model ...
saved!
save new best model: last-best-loss: 0.23220, new-best-loss: 0.23219, epoch: 42
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:35,  5.02s/it]
epoch 43, weight=0.50000, train-loss=0.81739, eval-loss=0.88098, val-loss=0.23219,
plotting ...
save model ...
saved!
save new best model: last-best-loss: 0.23219, new-best-loss: 0.23219, epoch: 43
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:35,  5.08s/it]
epoch 44, weight=0.50000, train-loss=0.85288, eval-loss=0.88095, val-loss=0.23218,
plotting ...
save model ...
saved!
save new best model: last-best-loss: 0.23219, new-best-loss: 0.23218, epoch: 44
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:38,  5.45s/it]
epoch 45, weight=0.50000, train-loss=0.87872, eval-loss=0.88093, val-loss=0.23218,
plotting ...
save model ...
saved!
save new best model: last-best-loss: 0.23218, new-best-loss: 0.23218, epoch: 45
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:36,  5.25s/it]
epoch 46, weight=0.50000, train-loss=0.89303, eval-loss=0.88091, val-loss=0.23217,
plotting ...
save model ...
saved!
save new best model: last-best-loss: 0.23218, new-best-loss: 0.23217, epoch: 46
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:34,  4.95s/it]
epoch 47, weight=0.50000, train-loss=0.94516, eval-loss=0.88089, val-loss=0.23217,
plotting ...
save model ...
saved!
save new best model: last-best-loss: 0.23217, new-best-loss: 0.23217, epoch: 47
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







7it [00:35,  5.06s/it]
epoch 48, weight=0.50000, train-loss=0.86916, eval-loss=0.88086, val-loss=0.23216,
plotting ...
0it [00:00, ?it/s]
save model ...
saved!
save new best model: last-best-loss: 0.23217, new-best-loss: 0.23216, epoch: 48
saved!
----------------------------------------------------------------------------------------------------







7it [00:35,  5.08s/it]
epoch 49, weight=0.50000, train-loss=0.81101, eval-loss=0.88084, val-loss=0.23215,
plotting ...
save model ...
saved!
save new best model: last-best-loss: 0.23216, new-best-loss: 0.23215, epoch: 49
saved!
----------------------------------------------------------------------------------------------------
New loss weight : 0.5







